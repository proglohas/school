<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ç°¡è€å¸«çš„æ’åºæ³•è¨“ç·´</title>
    <style>
        /* æµ®æ°´å°èƒŒæ™¯è¨­å®š */
        body { 
            font-family: 'PingFang TC', sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background-color: #f0f2f5; 
            margin: 0;
            min-height: 100vh;
            position: relative;
        }

        /* æµ®æ°´å°å±¤ */
        body::before {
            content: "ç°¡è€å¸«çš„æ’åºæ³•è¨“ç·´";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            font-size: 40px;
            color: rgba(0, 0, 0, 0.03); /* æ¥µæ·¡çš„é€æ˜åº¦ */
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(-30deg);
            pointer-events: none; /* ç¢ºä¿ä¸å½±éŸ¿é»æ“Šæ“ä½œ */
            white-space: nowrap;
            z-index: -1;
            /* è®“æ–‡å­—åœ¨èƒŒæ™¯é‡è¤‡å‡ºç¾ */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><text x="50%" y="50%" font-size="24" fill="rgba(0,0,0,0.04)" font-family="Arial" text-anchor="middle" transform="rotate(-30, 200, 150)">ç°¡è€å¸«çš„æ’åºæ³•è¨“ç·´</text></svg>');
            background-repeat: repeat;
        }

        h2 { color: #333; margin-top: 20px; z-index: 1; }
        .container { margin-top: 40px; display: flex; flex-direction: column; gap: 30px; align-items: center; z-index: 1; }
        
        .row { display: flex; gap: 12px; min-height: 120px; }
        
        /* ç‰Œæ¨£å¼ */
        .card {
            width: 70px; height: 100px;
            background: white; border: 2px solid #333;
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            font-size: 24px; font-weight: bold; position: relative;
            box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
        }

        /* è™›æ¡†æ¨£å¼ */
        .slot {
            width: 70px; height: 100px;
            border: 2px dashed #bbb; border-radius: 8px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: not-allowed; background: rgba(255, 255, 255, 0.5);
            position: relative;
        }

        .slot.active { 
            border-color: #0984e3; 
            background: #e3f2fd; 
            cursor: pointer; 
            border-width: 3px; 
        }
        
        .down-label {
            color: #0984e3;
            font-size: 20px;
            font-weight: bold;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .empty-slot {
            width: 70px; height: 100px;
            background: #dfe6e9; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
        }

        .move-btn {
            background: #ff7675; color: white; border: none;
            padding: 4px 8px; border-radius: 4px; cursor: pointer;
            font-size: 14px; position: absolute; bottom: -30px;
            white-space: nowrap;
        }
        
        .fill-btn {
            background: #55efc4; color: #2d3436; border: none;
            padding: 5px 12px; border-radius: 4px; cursor: pointer; font-weight: bold;
        }

        #reload-btn {
            padding: 10px 25px; font-size: 16px; cursor: pointer;
            background: #636e72; color: white; border: none; border-radius: 5px;
        }
        
        .status { margin-top: 20px; font-size: 1.1rem; font-weight: bold; height: 30px; }
        .error { color: #d63031; }
        .info { color: #0984e3; }
        .success { color: #27ae60; }
    </style>
</head>
<body>

    <h2>ğŸƒ ç°¡è€å¸«çš„æ’åºæ³•è¨“ç·´ (Insertion Sort)</h2>

    <div class="container">
        <div id="upper-row" class="row"></div>
        <div id="lower-row" class="row"></div>
        <button id="reload-btn">é‡æ–°æ´—ç‰Œ (Reload)</button>
        <div id="message" class="status"></div>
    </div>

<script>
    const upperRow = document.getElementById('upper-row');
    const lowerRow = document.getElementById('lower-row');
    const message = document.getElementById('message');
    const reloadBtn = document.getElementById('reload-btn');

    let upperCards = [];
    let tempCard = null;
    let nextToProcess = 1; 

    function init() {
        upperRow.innerHTML = '';
        lowerRow.innerHTML = '';
        nextToProcess = 1;
        tempCard = null;
        upperCards = Array.from({length: 13}, (_, i) => i + 1)
                          .sort(() => Math.random() - 0.5)
                          .slice(0, 10);

        showMessage('è«‹é»æ“Šå¸¶æœ‰ â¬‡ æ¨™ç±¤çš„è™›æ¡†é–‹å§‹è™•ç†', 'info');
        render();
    }

    function showMessage(msg, type) {
        message.textContent = msg;
        message.className = 'status ' + type;
    }

    function render() {
        upperRow.innerHTML = '';
        lowerRow.innerHTML = '';

        upperCards.forEach((val, i) => {
            const slot = document.createElement('div');
            if (val === null) {
                slot.className = 'empty-slot';
                if (tempCard !== null) {
                    const btn = document.createElement('button');
                    btn.className = 'fill-btn';
                    btn.textContent = 'å¡«å…¥';
                    btn.onclick = () => insertCard(i);
                    slot.appendChild(btn);
                }
            } else {
                slot.className = 'card';
                slot.textContent = val;
                if (upperCards[i+1] === null && tempCard !== null && val > tempCard) {
                    const moveBtn = document.createElement('button');
                    moveBtn.className = 'move-btn';
                    moveBtn.textContent = 'å³ç§» â†’';
                    moveBtn.onclick = () => shiftCard(i);
                    slot.appendChild(moveBtn);
                }
            }
            upperRow.appendChild(slot);
        });

        for (let i = 0; i < 10; i++) {
            const slot = document.createElement('div');
            slot.className = 'slot';
            if (tempCard === null && i === nextToProcess && nextToProcess < 10) {
                slot.classList.add('active');
                slot.innerHTML = '<div class="down-label">â¬‡</div>';
                slot.onclick = () => pickCard(i);
            }
            if (tempCard !== null && i === nextToProcess) {
                slot.innerHTML = `<div class="card">${tempCard}</div>`;
            }
            lowerRow.appendChild(slot);
        }
    }

    function pickCard(index) {
        tempCard = upperCards[index];
        upperCards[index] = null;
        showMessage(`æ‹¿èµ· ${tempCard}ã€‚è«‹æ¯”è¼ƒå·¦å´ï¼Œè‹¥å·¦æ–¹è¼ƒå¤§å‰‡é»æ“Šå³ç§»ã€‚`, 'info');
        render();
    }

    function shiftCard(index) {
        upperCards[index + 1] = upperCards[index];
        upperCards[index] = null;
        showMessage(`å·²å°‡è¼ƒå¤§çš„æ•¸ç§»å‹•ã€‚`, 'info');
        render();
    }

    function insertCard(index) {
        if (index > 0 && upperCards[index - 1] > tempCard) {
            showMessage(`éŒ¯èª¤ï¼å·¦é‚Šçš„ ${upperCards[index - 1]} æ¯”è¼ƒå¤§ï¼Œå¿…é ˆå…ˆå³ç§»å®ƒï¼`, 'error');
            return;
        }

        upperCards[index] = tempCard;
        tempCard = null;
        nextToProcess++;

        if (nextToProcess < 10) {
            showMessage(`æˆåŠŸæ­¸ä½ï¼è«‹ç¹¼çºŒä¸‹ä¸€å¼µã€‚`, 'success');
        } else {
            showMessage(`ğŸ‰ æ­å–œï¼å…¨æ•¸æ’åºå®Œæˆï¼`, 'success');
        }
        render();
    }

    reloadBtn.onclick = init;
    init();
</script>

</body>
</html>